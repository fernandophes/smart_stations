localhost
8484

    private SecureMessenger useSymmetric(final Message locationResponse) {
        final var asymmetricHost = (String) locationResponse.getValues().get(Fields.HOST);
        final var asymmetricPort = (int) locationResponse.getValues().get(Fields.PORT);
        final var publicKey = (String) locationResponse.getValues().get(Fields.PUBLIC_KEY);

        final var asymmetricCryptoService = CryptoServiceFactory.publicRsa(publicKey);
        final var asymmetricMessenger = MessengerFactory.secureUdp(asymmetricHost, asymmetricPort,
                asymmetricCryptoService);

        final var request = new Message(MessageType.USE_SYMMETRIC);
        asymmetricMessenger.send(request);

        final var response = asymmetricMessenger.receive();
        final var symmetricPort = (int) response.getValues().get(Fields.PORT);
        final var encryptionKey = (String) response.getValues().get("ENCRYPTION_KEY");
        final var hmacKey = (String) response.getValues().get("HMAC_KEY");

        final var symmetricCryptoService = CryptoServiceFactory.aes(encryptionKey, hmacKey);
        return MessengerFactory.secureUdp(asymmetricHost, symmetricPort, symmetricCryptoService);
    }
